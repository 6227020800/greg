{"id":"Wsof","dependencies":[{"name":"/home/strukturart/Desktop/Pages/greg/package.json","includedInParent":true,"mtime":1644931973019},{"name":"/assets/js/helper.js","loc":{"line":1,"column":27,"index":27},"parent":"/home/strukturart/Desktop/Pages/greg/application/assets/js/scan.js","resolved":"/home/strukturart/Desktop/Pages/greg/application/assets/js/helper.js"},{"name":"jsqr","loc":{"line":2,"column":17,"index":68},"parent":"/home/strukturart/Desktop/Pages/greg/application/assets/js/scan.js","resolved":"/home/strukturart/Desktop/Pages/greg/node_modules/jsqr/dist/jsQR.js"},{"name":"../../app.js","loc":{"line":3,"column":23,"index":99},"parent":"/home/strukturart/Desktop/Pages/greg/application/assets/js/scan.js","resolved":"/home/strukturart/Desktop/Pages/greg/application/app.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.stop_scan = exports.start_scan = void 0;\n\nvar _helper = require(\"/assets/js/helper.js\");\n\nvar _jsqr = _interopRequireDefault(require(\"jsqr\"));\n\nvar _app = require(\"../../app.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar video;\nvar intv;\n\nvar stop_scan = function stop_scan() {\n  // status.views = \"subscription\";\n  document.getElementById(\"qr-screen\").style.display = \"none\";\n  /*\n  const stream = video.srcObject;\n  const tracks = stream.getTracks();\n   tracks.forEach(function (track) {\n    track.stop();\n    document.getElementById(\"qr-screen\").style.display = \"none\";\n  });\n   video.srcObject = null;\n  */\n};\n\nexports.stop_scan = stop_scan;\n\nvar start_scan = function start_scan(callback) {\n  document.getElementById(\"qr-screen\").style.display = \"block\";\n  console.log(\"start\");\n  navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n\n  if (navigator.getUserMedia) {\n    navigator.getUserMedia({\n      audio: false,\n      video: {\n        width: 200,\n        height: 200\n      }\n    }, function (stream) {\n      video = document.querySelector(\"video\");\n      video.srcObject = stream;\n\n      video.onloadedmetadata = function (e) {\n        video.play();\n        var barcodeCanvas = document.createElement(\"canvas\");\n        intv = setInterval(function () {\n          barcodeCanvas.width = video.videoWidth;\n          barcodeCanvas.height = video.videoHeight;\n          var barcodeContext = barcodeCanvas.getContext(\"2d\");\n          var imageWidth = Math.max(1, Math.floor(video.videoWidth)),\n              imageHeight = Math.max(1, Math.floor(video.videoHeight));\n          barcodeContext.drawImage(video, 0, 0, imageWidth, imageHeight);\n          var imageData = barcodeContext.getImageData(0, 0, imageWidth, imageHeight);\n          var idd = imageData.data;\n          var code = (0, _jsqr.default)(idd, imageWidth, imageHeight);\n          console.log(code);\n\n          if (code) {\n            stop_scan();\n            callback(code.data);\n            clearInterval(intv);\n          }\n        }, 1000);\n      };\n    }, function (err) {\n      console.log(\"The following error occurred: \" + err.name);\n    });\n  } else {\n    console.log(\"getUserMedia not supported\");\n  }\n};\n\nexports.start_scan = start_scan;"},"sourceMaps":null,"error":null,"hash":"ef2466ea53d104d1b640c566412ee5b9","cacheData":{"env":{}}}