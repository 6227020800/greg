parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Focm":[function(require,module,exports) {
"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}var t,n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=new Date,o=a.getMonth(),r=a.getFullYear(),d=a.getDate(),c=document.getElementById("monthAndYear"),l=!1,u={view:"month",selected_day:"",visible:!1,update_event_id:""},m={},s="",v=[],g=function(e){if(!navigator.mozApps)return!1;var t=navigator.mozApps.getSelf();t.onsuccess=function(){e(t.result)},t.onerror=function(){}};function f(e){t=e.origin;var n=document.getElementById("KaiOsAds-Wrapper");"app://kaios-plus.kaiostech.com"==e.installOrigin?document.querySelector("#KaiOsAds-Wrapper iframe").src="ads.html":(console.log("Ads free"),n.style.display="none")}g(f);var y=function(e){for(var t=0,n=new Date(e).getTime(),i=0;i<v.length;i++){n<new Date(v[i].dateStart).getTime()&&(t=v[i-1].dateStart,i=v.length),n>new Date(v[v.length-1].dateStart).getTime()&&(t=v[v.length-1].dateStart,i=v.length)}return document.querySelectorAll("div#list-view article[data-date='"+t+"']")[0].focus(),t},p=function(t){for(var n={date:"",event:!1,subscription:!1,multidayevent:!1,rrule:"none"},i=0;i<v.length;i++)if("object"===e(v[i])){n.event=!1,n.subscription=!1,n.multidayevent=!1,n.rrule=!1,n.date=t;var a=new Date(v[i].dateStart).getTime(),o=new Date(v[i].dateEnd).getTime(),r=new Date(t).getTime();"none"==v[i].rrule_&&(a===r||o===r||a<r&&o>r)&&(n.event=!0,!0===v[i].isSubscription&&(n.subscription=!0),!0===v[i].multidayevent&&(n.multidayevent=!0),i=v.length)}return n},E=function(t){for(var n={date:"",event:!1,subscription:!1,multidayevent:!1,rrule:"none"},i=0;i<v.length;i++)if("object"===e(v[i])){n.event=!1,n.subscription=!1,n.multidayevent=!1,n.rrule=!1,n.date=t;new Date(v[i].dateStart).getTime(),new Date(v[i].dateEnd).getTime(),new Date(t).getTime();if(void 0!==v[i].rrule_&&void 0!==v[i].rrule_&&new Date(v[i].dateStart).getTime()<=new Date(t).getTime()&&new Date(t).getTime()<=new Date(v[i].dateEnd).getTime()){if("MONTHLY"==v[i].rrule_&&new Date(v[i].dateStart).getDate()===new Date(t).getDate())return n.rrule=!0,i=v.length,n;if("DAILY"==v[i].rrule_)return n.rrule=!0,i=v.length,n;if("WEEKLY"==v[i].rrule_&&new Date(v[i].dateStart).getDay()===new Date(t).getDay())return n.rrule=!0,i=v.length,n;if("YEARLY"==v[i].rrule_){var a=new Date(v[i].dateStart),o=new Date(t);if(a.getDate()+"-"+a.getMonth()==o.getDate()+"-"+o.getMonth())return n.rrule=!0,i=v.length,n}}}return n},h=[],b=0,w=function(e){h=[];var t=document.querySelector("div#event-slider-indicator div");t.innerHTML="";for(var n=document.querySelectorAll("div#event-slider article"),i=0;i<n.length;i++)n[i].style.display="none";for(var a=document.querySelectorAll("div#event-slider article"),o=0;o<a.length;o++){var r=new Date(a[o].getAttribute("data-date")).getTime(),d=new Date(a[o].getAttribute("data-date-end")).getTime(),c=new Date(e).getTime(),l=a[o].getAttribute("data-rrule");if("none"===l||""===l)(r===c||d===c||r<c&&d>c)&&(h.push(a[o]),h[0].style.display="block",t.insertAdjacentHTML("beforeend","<div class='indicator'></div>"));else if(r===c||d===c||r<c&&d>c&&l){if("YEARLY"==l){var u=new Date(a[o].getAttribute("data-date")),m=new Date(e);u.getDate()+"-"+u.getMonth()==m.getDate()+"-"+m.getMonth()&&(h.push(a[o]),h[0].style.display="block",t.insertAdjacentHTML("beforeend","<div class='indicator'></div>"))}"WEEKLY"==l&&new Date(a[o].getAttribute("data-date")).getDay()==new Date(e).getDay()&&(h.push(a[o]),h[0].style.display="block",t.insertAdjacentHTML("beforeend","<div class='indicator'></div>")),"MONTHLY"==l&&new Date(a[o].getAttribute("data-date")).getDate()==new Date(e).getDate()&&(h.push(a[o]),h[0].style.display="block",t.insertAdjacentHTML("beforeend","<div class='indicator'></div>")),"DAILY"==l&&(r===c||d===c||r<c&&d>c)&&(h.push(a[o]),h[0].style.display="block",t.insertAdjacentHTML("beforeend","<div class='indicator'></div>"))}}""!=h&&h.length>0?t.style.opacity=100:t.style.opacity=0},A=function(){var e=document.querySelectorAll("div#event-slider-indicator div div");b==h.length-1&&(b=-1),b++,h.forEach(function(e){e.style.display="none"}),h[b].style.display="block",e.forEach(function(e){e.classList.remove("active")}),e[b].classList.add("active")},I=function(){var e=a.getMonth(),t=a.getFullYear();T(e,t),console.log(e),w(u.selected_day),u.selected_day=document.activeElement.getAttribute("data-date")};function B(){r=11===o?r+1:r,T(o=(o+1)%12,r),w(u.selected_day)}function D(){r=0===o?r-1:r,T(o=0===o?11:o-1,r),w(u.selected_day)}Date.prototype.getWeek=function(){var e=new Date(this.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var t=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)};var T=function(e,t){helper.bottom_bar("add","events","options");var i=new Date(t,e).getDay(),o=32-new Date(t,e,32).getDate(),r=document.getElementById("calendar-body");r.innerHTML="",c.innerHTML=n[e]+" "+t;for(var l=1,m=0;m<6;m++){var s=document.createElement("div");s.classList.add("flex"),s.classList.add("row"),s.classList.add("width-100");for(var g=0;g<7;g++)if(0===m&&g<i){var f=document.createElement("div"),y=document.createTextNode("");f.appendChild(y),s.appendChild(f)}else{if(l>o)break;var h=document.createElement("div"),b=document.createElement("span"),w=document.createElement("div"),A=document.createTextNode(l);h.appendChild(A),h.appendChild(b),h.setAttribute("tabindex",l-1);var I=t+"-"+"0".concat(e+1).slice(-2)+"-"+"0".concat(l).slice(-2);w.classList.add("moon-phase-"+getMoonPhase(t,e,l)),h.appendChild(w),h.setAttribute("data-date",I),h.setAttribute("data-index",new Date(I).toISOString()),v.length>0&&(p(I).event&&h.classList.add("event"),E(I).rrule&&h.classList.add("event"),1==p(I).subscription&&h.classList.add("subscription")),h.classList.add("item"),s.appendChild(h),l++}var B=document.createElement("span");B.classList.add("weeknumber");var D=document.createTextNode(new Date(t,e,l).getWeek());B.appendChild(D),s.appendChild(B),r.appendChild(s)}document.querySelectorAll(".item")[0].focus(),u.selected_day=document.activeElement.getAttribute("data-date"),a.getMonth()==e&&a.getFullYear()==t&&(document.querySelectorAll(".item")[d-1].focus(),document.querySelectorAll(".item")[d-1].classList.add("today"))},S=function(){document.querySelectorAll("div#list-view article").forEach(function(e,t){e.setAttribute("tabindex",t)})};function _(e){document.getElementById("event-slider").style.opacity=0,helper.sort_array(e,"dateStart","date");var t=document.getElementById("template").innerHTML,a=Mustache.render(t,{data:e});document.getElementById("list-view").innerHTML=a,document.getElementById("event-slider").innerHTML=a,document.getElementById("event-slider").style.opacity=100,S(),document.querySelectorAll("article").forEach(function(e){var t=new Date(e.getAttribute("data-date")),a=new Date(e.getAttribute("data-date-end")),o=i[t.getDay()]+", "+t.getFullYear()+" "+n[t.getMonth()]+" "+t.getDate(),r=i[a.getDay()]+", "+a.getFullYear()+" "+n[a.getMonth()]+" "+a.getDate();e.classList.contains("multidayevent")?e.querySelector("div.date").innerText=o+" - "+r:e.querySelector("div.date").innerText=o})}var L=function(){Array.from(document.querySelectorAll("div#add-edit-event input")).forEach(function(e){e.value="",document.getElementById("form-image").src="",s=""})},M=document.getElementById("calendar"),k=document.getElementById("add-edit-event"),R=document.getElementById("list-view"),q=document.getElementById("options"),x=function(){setTimeout(function(){if("options"==u.view)return"subscription"==document.activeElement.getAttribute("data-function")?(helper.bottom_bar("delete","select",""),!0):(helper.bottom_bar("","select",""),!0)},500)},N=document.querySelectorAll(".page"),C=function(e){if(Array.from(N).forEach(function(e){e.style.display="none"}),"view"==e&&("month"==u.view?u.view="list-view":u.view="month"),"add-edit-event"==u.view)return document.activeElement.hasAttribute("data-date")&&(u.selected_day=document.activeElement.getAttribute("data-date")),document.getElementById("event-date").value=u.selected_day,k.style.display="block",Array.from(document.querySelectorAll("div#add-edit-event .item")).forEach(function(e,t){e.setAttribute("tabindex",t)}),k.querySelectorAll(".item")[0].focus(),helper.bottom_bar("","edit",""),""==document.getElementById("event-date-end").value&&(document.getElementById("event-date-end").value=document.getElementById("event-date").value),u.edit_event&&(document.getElementById("save-event").innerText="update"),console.log(u.edit_event),u.edit_event||(document.getElementById("save-event").innerText="save",document.getElementById("event-notification-time").value=m.default_notification),!0;if("month"==u.view){document.activeElement.hasAttribute("data-date")&&(u.selected_day=document.activeElement.getAttribute("data-date")),q.style.display="none",M.style.display="block",helper.bottom_bar("add","events","options"),u.edit_event=!1;var t=new Date(u.selected_day);o=t.getMonth(),r=t.getFullYear();var n=u.selected_day;T(o,r),Array.from(document.querySelectorAll("div#calendar-body div.item")).forEach(function(e){e.getAttribute("data-date")==n&&(e.focus(),w(n))}),L()}"list-view"==u.view&&(document.activeElement.hasAttribute("data-date")&&(u.selected_day=document.activeElement.getAttribute("data-date")),q.style.display="none",u.edit_event=!1,L(),helper.bottom_bar("edit","month","options"),R.style.display="block",setTimeout(function(){for(var e=document.querySelectorAll("div#list-view article"),t=!1,n=0;n<e.length;n++)e[n].getAttribute("data-date")==u.selected_day&&(e[n].focus(),n=e.length,t=!0);for(n=0;n<e.length;n++)console.log(e[n].getAttribute("data-alarm")),"none"==e[n].getAttribute("data-alarm")&&(e[n].querySelector("img.bell").style.display="none");t||(document.querySelectorAll("div#list-view article")[0].focus(),y(u.selected_day));var i=document.activeElement.getBoundingClientRect(),a=i.top-document.body.getBoundingClientRect().top+i.height/2;document.activeElement.parentNode.scrollBy({left:0,top:a-window.innerHeight/2,behavior:"smooth"})},1e3)),"options"==u.view&&(document.activeElement.hasAttribute("data-date")&&(u.selected_day=document.activeElement.getAttribute("data-date")),l||(eximport.list_ics(),U(),l=!0),document.getElementById("options").style.display="block",document.querySelectorAll("div#options .item")[0].focus(),document.getElementById("options").style.opacity="1",document.getElementById("subscription-form").style.display="none",setTimeout(function(){Array.from(document.querySelectorAll("div#options .item")).forEach(function(e,t){e.setAttribute("tabindex",t)})},2e3),x()),"subscription"==u.view&&(document.getElementById("options").style.opacity="0.3",document.getElementById("subscription-form").style.display="block",document.querySelectorAll("div#subscription-form div.item input")[0].focus(),helper.bottom_bar("QR","","save"))},U=function(){if(null==F)return!1;F.forEach(function(e){document.querySelector("div#options div#subscription-text").insertAdjacentHTML("afterend",'<button class="item dynamic" data-function="subscription">'+e.name+"</button>"),Array.from(document.querySelectorAll("div#options button")).forEach(function(e,t){e.setAttribute("tabindex",t)})})},O=0,Y=function e(){if(null==F||-1==F.lenght||"undefined"==F.lenght)return!1;O<F.length&&(eximport.fetch_ics(F[O].url,e),O++,helper.toaster("subscriptions loaded",2e3)),I(),_(v),w(document.activeElement.getAttribute("data-date")),document.activeElement.hasAttribute("data-date")&&(u.selected_day=document.activeElement.getAttribute("data-date"))},H=function(e){helper.bottom_bar("QR","save","cancel"),document.querySelector("div#subscription-form input#cal-subs-url").value=e},F=new Array,z=function(){console.log(F),helper.validate(document.getElementById("cal-subs-url").value)&&""!=document.getElementById("cal-subs-name").value?((F=[]).push({url:document.getElementById("cal-subs-url").value,name:document.getElementById("cal-subs-name").value}),document.querySelector("input#cal-subs-name").val="",document.querySelector("input#cal-subs-url").val="",localforage.setItem("subscriptions",F).then(function(e){document.getElementById("subscription-form").style.display="none",helper.toaster("subscription stored",2e3),u.view="options",C()}).catch(function(e){console.log(e)}),Y(),U()):helper.toaster("Please enter a name and a valid url",2e3)},j=function(){var e=F.filter(function(e){return e.name!=document.activeElement.innerText});localforage.setItem("subscriptions",e).then(function(e){console.log("saved: "+e),helper.toaster("subscription deleted",2e3),u.view="month",C()}).catch(function(e){helper.toaster(e,2e3)}),document.activeElement.remove()};function P(){"hidden"===document.visibilityState?u.visible=!1:setTimeout(function(){u.visible=!0},1e3)}localforage.getItem("events").then(function(e){null!=e&&(v=e),_(v),I()}).catch(function(e){I()}),localforage.getItem("subscriptions").then(function(e){F=e,setTimeout(function(){if(null==F)return!1;Y(),console.log(F)},2e3)}).catch(function(e){console.log(e)}),localforage.getItem("settings").then(function(e){if(null==e)return!1;m=e,document.getElementById("default-notification-time").value=m.default_notification}).catch(function(e){console.log(e)}),P();var W=function(e){if("SELECT"==document.activeElement.nodeName||"date"==document.activeElement.type||"time"==document.activeElement.type)return!1;var t=document.activeElement.tabIndex+e,n=0;"month"==u.view&&(n=document.activeElement.parentNode.parentNode.querySelectorAll(".item"));"list-view"==u.view&&(n=document.activeElement.parentNode.querySelectorAll("div#list-view article"));if("subscription"==u.view&&(n=document.querySelectorAll("div#subscription-form > div.item")),"add-edit-event"==u.view||"options"==u.view){if(n=document.activeElement.parentNode.querySelectorAll(".item"),document.activeElement.parentNode.classList.contains("input-parent"))return document.activeElement.parentNode.focus(),!0;document.getElementById("add-edit-event").firstElementChild.focus()}var i=0;t<=n.length&&(i=n[t]).focus(),t==n.length&&(i=n[0]).focus();var a=document.activeElement.getBoundingClientRect(),o=a.top-document.body.getBoundingClientRect().top+a.height/2;return document.activeElement.parentNode.scrollBy({left:0,top:o-window.innerHeight/2,behavior:"smooth"}),"month"==u.view||"list-view"==u.view?(i.hasAttribute("data-date")&&(u.selected_day=i.getAttribute("data-date"),u.selected_day_id=i.getAttribute("data-id"),w(u.selected_day)),!0):"form-image-wrapper"==document.activeElement.id&&"add-edit-event"==u.view?(helper.bottom_bar("","remove image",""),!0):"form-image-wrapper"!=document.activeElement.id&&"add-edit-event"==u.view?(helper.bottom_bar("","edit",""),!0):void 0};document.getElementById("event-notification-time").addEventListener("change",function(e){setTimeout(function(){document.getElementById("event-notification-time").parentElement.focus()},500)}),m.default_notification="none",document.getElementById("default-notification-time").addEventListener("change",function(e){var t=document.getElementById("default-notification-time").value;m.default_notification=t,localforage.setItem("settings",m).then(function(e){}).catch(function(e){console.log(e)}),setTimeout(function(){document.getElementById("default-notification-time").parentElement.focus()},500)}),document.querySelectorAll('input[type="time"]').forEach(function(e){e.addEventListener("change",function(t){setTimeout(function(){e.parentElement.focus()},500)})}),document.querySelectorAll('input[type="date"]').forEach(function(e){e.addEventListener("change",function(t){setTimeout(function(){e.parentElement.focus()},500)})});var V=function(e,t,n){if(navigator.mozAlarms){var i={foo:t,event_id:n},a=navigator.mozAlarms.add(e,"honorTimezone",i);a.onsuccess=function(){},a.onerror=function(){console.log("An error occurred: "+this.error.name)}}},G=function(e){if(navigator.mozAlarms){var t=navigator.mozAlarms.getAll();t.onsuccess=function(){this.result.forEach(function(t){if(t.data.event_id==e){var n=navigator.mozAlarms.remove(t.id);n.onsuccess=function(){console.log("removed")},n.onerror=function(){console.log("An error occurred: "+this.error.name)}}else console.log("no alarm founded")})},t.onerror=function(){console.log("An error occurred:",this.error.name)}}},J=function(){if(navigator.mozAlarms){var e=navigator.mozAlarms.getAll();e.onsuccess=function(){this.result.forEach(function(e){console.log("Id:",e.id),console.log("date:",e.date),console.log("respectTimezone:",e.respectTimezone),console.log("data:",JSON.stringify(e.data))})},e.onerror=function(){console.log("An error occurred:",this.error.name)}}},K=function(e){var t=e.replace(/-/g,"");return t=(t=t.replace(/:/g,"")).replace(" ","T"),t+="00"},Q=[],X=function(){var e="00:00:00";""!=document.getElementById("event-time-start").value&&(e=document.getElementById("event-time-start").value);var t="00:00:00";""!=document.getElementById("event-time-end").value&&(t=document.getElementById("event-time-end").value);var n=document.getElementById("event-date").value+" "+e;""==document.getElementById("event-date-end").value&&(document.getElementById("event-date-end").value=document.getElementById("event-date").value);var i,a=document.getElementById("event-date-end").value+" "+t,o=document.getElementById("event-notification-time").value;"none"!=o&&((i=new Date(n)).setMinutes(i.getMinutes()-o),o=K(i.toISOString()));var r=!1;new Date(document.getElementById("event-date").value).getTime()!=new Date(document.getElementById("event-date-end").value).getTime()&&(r=!0);var d,c,l={UID:helper.uid(),SUMMARY:document.getElementById("event-title").value,LOCATION:document.getElementById("event-location").value,DESCRIPTION:document.getElementById("event-description").value,CLASS:"PRIVATE",DTSTAMP:K(n),DTSTART:K(n),DTEND:K(a),RRULE:(c=document.getElementById("event-recur").value,""==c&&"none"==c||(d="FREQ="+document.getElementById("event-recur").value+";UNTIL="+K(a)),d),rrule_:document.getElementById("event-recur").value,dateStart:document.getElementById("event-date").value,dateEnd:document.getElementById("event-date-end").value,time_start:document.getElementById("event-time-start").value,time_end:document.getElementById("event-time-end").value,alarm:document.getElementById("event-notification-time").value,alarmTrigger:o,isSubscription:!1,multidayevent:r,ATTACH:s};"none"!=l.alarm&&(l.BEGIN="VALARM",l["TRIGGER;VALUE=DATE-TIME"]=o,l.ACTION="AUDIO",l.END="VALARM",V(i,l.SUMMARY,l.UID)),v.push(l);var m=v.filter(function(e){return!1===e.isSubscription});localforage.setItem("events",m).then(function(e){helper.toaster("saved",2e3),L(),_(v),eximport.export_ical("greg.ics",m)}).catch(function(e){}),u.view="month",C()},Z=function(){v.forEach(function(e){var t,n,i=!1;if(new Date(document.getElementById("event-date").value).getTime()!=new Date(document.getElementById("event-date-end").value).getTime()&&(i=!0),e.UID==u.selected_day_id){var a="00:00:00";""!=document.getElementById("event-time-start").value&&(a=document.getElementById("event-time-start").value);var o="00:00:00";""!=document.getElementById("event-time-end").value&&(o=document.getElementById("event-time-end").value);var r=document.getElementById("event-date").value+" "+a,d=document.getElementById("event-date").value+" "+o,c=document.getElementById("event-notification-time").value,l="";"none"!=c&&((l=new Date(r)).setMinutes(l.getMinutes()-c),c=K(l.toISOString()));e.SUMMARY=document.getElementById("event-title").value,e.DESCRIPTION=document.getElementById("event-description").value,e.LOCATION=document.getElementById("event-location").value,e.DTSTART=K(r),e.DTEND=K(d),e.dateEnd=document.getElementById("event-date-end").value,e.dateStart=document.getElementById("event-date").value,e.time_start=document.getElementById("event-time-start").value,e.time_end=document.getElementById("event-time-end").value,e.RRULE=(""==(n=document.getElementById("event-recur").value)&&"none"==n||(t="FREQ="+document.getElementById("event-recur").value+";UNTIL="+K(d)),t),e.rrule_=document.getElementById("event-recur").value,e.isSubscription=!1,e.multidayevent=i,e.alarm=document.getElementById("event-notification-time").value,e.alarmTrigger=c,""!=s&&(e.ATTACH=s),"none"!=e.alarm&&(G(e.UID),e.BEGIN="VALARM",e["TRIGGER;VALUE=DATE-TIME:"]=c,e.ACTION="AUDIO",e.END="VALARM",V(l,e.SUMMARY,e.UID))}});var e=v.filter(function(e){return!1===e.isSubscription});localforage.setItem("events",e).then(function(e){_(v),eximport.export_ical("greg.ics",e),u.view="month",C(),L()}).catch(function(e){})},$=function(){document.getElementById("delete-event").style.display="block",document.getElementById("export-event").style.display="block",v.forEach(function(e){e.UID==u.selected_day_id&&(document.getElementById("event-title").value=e.SUMMARY,document.getElementById("event-date").value=e.dateStart,document.getElementById("event-date-end").value=e.dateEnd,document.getElementById("event-time-start").value=e.time_start,document.getElementById("event-time-end").value=e.time_end,document.getElementById("event-description").value=e.DESCRIPTION,document.getElementById("event-location").value=e.LOCATION,document.querySelector("#event-notification-time").value=e.alarm,document.getElementById("form-image").src=e.ATTACH,document.getElementById("event-recur").value=e.rrule_)})},ee=function(){v=v.filter(function(e){return e.UID!=u.selected_day_id}),G(u.selected_day_id),u.edit_event=!1;var e=v.filter(function(e){return!1===e.isSubscription});return L(),localforage.setItem("events",e).then(function(e){_(v),eximport.export_ical("greg.ics",e)}).catch(function(e){console.log(e)}),!0},te=new Date,ne="0".concat(te.getMonth()+1).slice(-2),ie="0".concat(te.getDate()).slice(-2),ae=te.getFullYear();w(ae+"-"+ne+"-"+ie);var oe,re=function(e,t){helper.toaster("done",2e3),helper.bottom_bar("edit","","");var n=v.filter(function(e){return!1===e.isSubscription});localforage.setItem("events",n).then(function(e){_(v),eximport.export_ical("greg.ics",n)}).catch(function(e){})},de=function(){var e=new Date,t="0".concat(e.getHours()).slice(-2)+":"+"0".concat(e.getMinutes()).slice(-2),n="0".concat(e.getHours()+1).slice(-2);n>23&&(n="23");var i=n+":"+"0".concat(e.getMinutes()).slice(-2);document.getElementById("event-time-start").value=t,document.getElementById("event-time-end").value=i},ce=function(e){document.getElementById("form-image").src=URL.createObjectURL(e),document.getElementById("form-image-wrapper").classList.add("item"),document.querySelectorAll("div#add-edit-event .item").forEach(function(e,t){e.setAttribute("tabindex",t)});var t=new FileReader;t.onload=function(){s=t.result},t.readAsDataURL(e)},le=!1,ue=1e3;function me(e){e.key}function se(e){switch(e.key){case"0":break;case"Backspace":window.close();break;case"ArrowLeft":u.view}}function ve(e){switch(e.key){case"*":I();break;case"ArrowUp":"month"==u.view&&W(-7),"add-edit-event"!=u.view&&"list-view"!=u.view&&"options"!=u.view&&"subscription"!=u.view||W(-1);break;case"ArrowDown":"month"==u.view&&W(7),"add-edit-event"!=u.view&&"list-view"!=u.view&&"options"!=u.view&&"subscription"!=u.view||W(1);break;case"ArrowRight":if("month"!=u.view)return!0;W(1);break;case"ArrowLeft":if("month"!=u.view)return!0;W(-1);break;case"1":D();break;case"3":B();break;case"2":A();break;case"#":document.querySelectorAll("div#calendar div#calendar-body div div [class^='moon-phase-']").forEach(function(e){e.classList.toggle("active")});break;case"7":break;case"SoftRight":case"Alt":if(console.log(u.view),"month"==u.view)return u.view="options",C(),!0;if("subscription"==u.view)return z(),!0;break;case"SoftLeft":case"Control":if("list-view"==u.view){if(document.activeElement.classList.contains("subscription"))return helper.toaster("a subscription cannot be edited",2e3),!1;u.selected_day_id=document.activeElement.getAttribute("data-id"),u.edit_event=!0,$(),u.view="add-edit-event",C()}if("subscription"==u.view)return qr.start_scan(H),!0;if("options"==u.view)return j(),!0;if("month"==u.view)return u.view="add-edit-event",C(),de(),!0;break;case"Enter":if(!u.visible)return!1;if(document.activeElement.classList.contains("input-parent"))return document.activeElement.children[1].focus(),!0;if("export-event"==document.activeElement.id)return v.forEach(function(e){e.UID==u.selected_day_id&&Q.push(e)}),eximport.export_ical(Q[0].UID+".ics",Q),helper.toaster("event exported",2e3),!0;if("select-image"==document.activeElement.id)return helper.pick_image(ce),!0;if("form-image-wrapper"==document.activeElement.id)return document.getElementById("form-image").src="",s="",!0;if("add-subscription"==document.activeElement.getAttribute("data-function"))return u.view="subscription",C(),!0;if("save-event"==document.activeElement.id)return u.edit_event?Z():X(),!0;if("delete-event"==document.activeElement.id)return ee()&&(u.view="month",C()),!0;if("options"==u.view)return"export"==document.activeElement.getAttribute("data-function")&&localforage.getItem("events").then(function(e){eximport.export_ical("greg.ics",e)}).catch(function(e){console.log(e)}),"import"==document.activeElement.getAttribute("data-function")&&eximport.loadICS(document.activeElement.getAttribute("data-filename"),re),!0;"month"!=u.view&&"list-view"!=u.view||C("view");break;case"Backspace":"add-edit-event"==u.view&&"INPUT"!=document.activeElement.tagName&&(u.view="month",C()),"options"==u.view&&(u.view="month",C()),"scan"==u.view&&(u.views="subscription",C())}}function ge(e){x(),"Backspace"===e.key&&("options"!=u.view&&"add-edit-event"!=u.view&&"scan"!=u.view||e.preventDefault()),"EndCall"===e.key&&(e.preventDefault(),window.close()),e.repeat||(le=!1,oe=setTimeout(function(){le=!0,se(e)},ue)),e.repeat&&("Backspace"==e.key&&(le=!1),me(e))}function fe(e){if(!1===u.visible)return!1;"Backspace"==e.key&&document.activeElement.tagName,clearTimeout(oe),le||ve(e)}document.addEventListener("keydown",ge),document.addEventListener("keyup",fe),document.addEventListener("visibilitychange",P,!1),navigator.serviceWorker.register("service-worker.js").then(function(e){console.log("Registration succeeded. Scope is "+e.scope)}).catch(function(e){console.log("Registration failed with "+e)});
},{"./service-worker.js":[["service-worker.js","AaGI"],"service-worker.js.map","AaGI"]}]},{},["Focm"], null)
//# sourceMappingURL=application.e1128523.js.map